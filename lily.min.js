/*
 lily.js a.k.a. LIght LibrarY JavaScript (c) 2011 ofk
 lily is licensed under the MIT.
 */
var ll=function(){function T(a,b){b+="";var c=a+b,d;if(!(d=U[c])){d=U;var e;if(b[V](0)===y){e=y+a;var g;g=(""+b[H](1))[I](W,X);e+=g}else e=a+(""+b)[I](W,X);d=d[c]=e}return d}function J(a,b){b+="";var c=a+b;return Y[c]||(Y[c]=b[V](0)===y?y+a+b[H](1)[Z]():a+b[Z]())}function r(){}function i(a){return a==null?-1:a[i[K]]||(a[i[K]]=++i[$])}function j(a){var b=typeof a;return aa[b]||(b=aa[ka[h](a)])?b:!a?la:a[ma]?na:a[oa]?ba:m in a&&typeof(b=a[m])===n&&(!b||b-1 in a)?z:s}function o(a){a==null&&(a={});for(var b=
arguments,c=1,d=b[m];c<d;++c){var e=b[c];if(e!=null)for(var g in e)a[g]=e[g]}return a}function L(a,b,c){if(j(a)===z)for(var d=0,e=a[m];d<e;++d){if(d in a&&b[h](c,a[d],d,a)===!1)return!1}else for(d in a)if(a[pa](d)&&b[h](c,a[d],d,a)===!1)return!1;return!0}function p(){}function A(){}function M(a,b){a[h](b+N,b);a[h](N,b);a[h](O+b)}function u(){}function P(a,b,c){switch(j(a)){case ca:return a;case n:case Q:return""+b===""+a;case da:return a[qa](b);case k:return!!a[h](c,b);default:return null}}function f(){}
var B=TypeError,C=Date,ea=isFinite,v="apply",z="array",ca="boolean",h="call",ra=h+"back",N="change",V="charAt",$="counter",R="error",k="function",pa="hasOwnProperty",K="key",m="length",S="load",ba="node",oa=ba+"Type",la="null",n="number",s="object",D="on"+R,fa="on"+S,ga="onreadystate"+N,da="regexp",sa="removeChild",ha="removeEventListener",I="replace",ma="setTimeout",H="slice",ia="splice",Q="string",qa="test",Z="toLowerCase",na="window",y="_",w="_llqueue",O="_notify";o(r,{guid:i,type:j,merge:o,each:L,
Slot:p,KVObject:A,Dispatch:u,Deferred:f});var W=/^[^a-zA-Z0-9]*[a-z]/,X=function(a){return a.toUpperCase()},U={},Y={};i[K]="_llguid";i[$]=0;var aa={undefined:1,"boolean":1,number:1,string:1,"[object Boolean]":ca,"[object Number]":n,"[object String]":Q,"[object RegExp]":da,"[object Array]":z,"[object Function]":k,"[object Date]":"date"},ka=Object.prototype.toString;p.createHandle=function(){function a(){for(var b=a[w],c=0,d=b[m];c<d;++c)b[c][v](this,arguments)===!1&&(b[ia](c--,1),--d)}a[w]=[];a.attach=
function(a){if(j(a)!==k)throw new B("first argument type should be function.");i(a);var c=this[w];c[c[m]]=a};a.detach=function(a){j(a)===k&&(a=i(a));for(var c=this[w],d=0,e=c[m];d<e;++d)if(a===i(c[d]))return c[ia](d,1),!0;return!1};return a};o(p.prototype,{attach:function(a,b){a=J("on",a);if(!this[a]||j(this[a].attach)!==k)this[a]=p.createHandle();this[a].attach(b);return this},detach:function(a,b){a=J("on",a);if(!this[a])return!0;var c=this[a];if(j(c.detach)!==k)throw new B("the handle function has no detach method.");
return!b?(c[w]=[],!0):c.detach(b)},call:function(a){var a=J("on",a),b=this[a];if(b&&j(b)===k)return b[v](this,Array.prototype[H][h](arguments,1))}});A.prototype=new p;o(A.prototype,{get:function(a){var b=this._llbindings;if(b&&(b=b[a]))return b.kvo.get(b.label);b=T("get",a);return this[b]&&j(this[b])===k?this[b]():this[a]},set:function(a,b){var c=this._llbindings;if(c&&(c=c[a]))return c.kvo.set(c.label,b);c=T("set",a);this[c]&&j(this[c])===k?this[c](b):this[a]=b;M(this,a)},notify:function(a){var b=
this._llbindings;if(b&&(b=b[a]))return b.kvo.notify(b.label);M(this,a)},bindTo:function(a,b,c,d){var e=this,c=c||a;if(!(b instanceof A))throw new B("second argument type should be [object ll.KVObject].");e.unbind(a);var g=e._llbindings=e._llbindings||{};g[a]={kvo:b,label:c};b.attach(O+c,g[a].notify=function(){M(e,a)});d||e.notify(a)},unbind:function(a){var b=this._llbindings,c;if(b)if(a==null)for(c in b)this.unbind(c);else if(c=b[a])delete b[a],c.kvo.detach(O+c.label,c.notify),this.set(a,c.kvo.get(c.label))}});
u.parseUrl=/^(\w*:\/\/)?(?:([^\/:@]+)?:([^\/:@]+)?@)?([\w\._-]+)?(?::(\d*))?(\/[^\?#]*)?(\?[^#]*)?(#.*)?$/;o(u.prototype,{update:function(a,b){a!=null&&(this._defaultLocation=a);this._defaultName=b||this._defaultName||"href"},match:function(a,b){(this._stash=this._stash||[]).push({rule:a,callback:b});return this},call:function(){return this.run(this._defaultLocation,arguments)},run:function(a,b,c){var d=!1;if(a&&this._stash){var e=this._defaultName,g;if(j(a)===Q){var f=a,a={};a[e]=f}"pathname"in a||
(g=u.parseUrl.exec(a[e]||""));g?o(a,{protocol:g[1]||"",hostname:g[4]||"",port:g[5]||"",pathname:g[6]||"",search:g[7]||"",hash:g[8]||""}):a=o({},a);for(var h in{pathname:1,search:1,hash:1})if(a[h]){e=h;break}c=c||a;b=b||[];g={};f=0;for(h=this._stash[m];f<h;++f){var k=this._stash[f],i=a,E=g,l=e,q=k.rule,t=!0;if(j(q)!==s)t=P(q,i[l],i);else for(l in l=void 0,q){if(!(l in i)){t=!1;break}if(j(q[l])!==s){if(!P(q[l],i[l],i)){t=!1;break}}else{if(!E[l]){E[l]={};for(var F=i[l][I](/^\W+/,""),r=/([^&=]+)(?:=([^&]*))?/g,
n;n=r.exec(F);)E[l][n[1]]=n[2]}var F=E[l],p;for(p in q[l])if(!P(q[l][p],F[p],F)){t=!1;break}if(!t)break}}if(t&&(d=!0,k[ra][v](c,b)===!1))break}}return d}});if(typeof location===s)r.dispatch=new u,r.dispatch.update(location);f.delay=function(a,b){var c=setTimeout(a,b*1E3);return function(){clearTimeout(c)}};var ja=typeof window===s,x,G;f.nextTick=ja&&!window.opera&&(x=document)&&(G=x.head||x.getElementsByTagName("head")[0]||x.documentElement)?function(a){function b(){d=!0;c[fa]=c[D]=c[ga]=null;G[sa](c)}
var c=x.createElement("script"),d=!1;c.async="async";c.src="data:text/javascript,";c[fa]=c[D]=c[ga]=function(){d||(b(),a())};G.insertBefore(c,G.firstChild);return b}:ja&&window.addEventListener?function(a){function b(){c();a()}function c(){d[ha](S,b,!1);d[ha](R,b,!1)}var d=new Image;d.addEventListener(S,b,!1);d.addEventListener(R,b,!1);d.src="data:image/png,"+Math.random();return c}:typeof process===s&&typeof process.nextTick===k?function(a){process.nextTick(a)}:null;o(f.prototype,{call:function(){return this._run("_ok",
arguments)},fail:function(){return this._run("_ng",arguments)},_run:function(a,b,c){var d=a,b=b||[];if(a in this){a=this[a];if(j(a)===k)try{a=a[v](this,b),d="_ok"}catch(e){a=e,d="_ng",f[D]&&f[D](e)}if(a instanceof f)return a._dfr=this._dfr,(!c||c(a))&&a._next(c),this;b=[a]}this._type=d;this._args=b;(!c||c(this))&&this._next(c);return this},_next:function(a){this._type&&this._dfr&&this._dfr._run(this._type,this._args,a)},then:function(a){return this._set("_ok",a)},lose:function(a){return this._set("_ng",
a)},_set:function(a,b){var c=new f;c[a]=b;this._dfr=c;this._next();return c},wait:function(a){return this.then(function(){return f.wait(a)})},when:function(a){return this.then(function(){var b=new f,c=j(a)===z?[]:{},d=1;L(a,function(a,g){++d;j(a)===k&&(a=f.then(a));a instanceof f?a.then(function(a){c[g]=a;!--d&&b[h](c)}).lose(function(a){b._run("_ng",[a],function(a){if(a._type==="_ng")return!0;!--d&&b[h](c);return!1})}):(c[g]=a,!--d&&b[h](c))});!--d&&b[h](c);return b})},each:function(a,b,c){return this._for(j(c)===
n?{time:c}:c,a,b)},loop:function(a,b){return this._for(j(a)===n?{end:a}:a,null,b)},_for:function(a,b,c){var a=o(null,a),d=+a.start||0,e=+a.end,g=+a.step||1,j=+a.time||0;if(b)a=b[m],!ea(e)||e>a?e=a:e<0&&(e=0),d>=a?d=a-1:d<0&&(d=0);else if(!ea(e))throw new B("options[_end_] type should be number.");if(d===e)return this;0<g!==d<e&&(g=-g);return this.then(function(){var a=new f,i=d,k=f.nextTick||f.delay,m=function(a){return a._type==="_ng"};a.cancel=k(function q(){var f=j?new C:null;do{if(!b||i in b)try{if((b?
c[h](a,b[i],i,b):c[h](a,i))===!1){a._run("_ng",null,m)[h]();return}}catch(n){a._run("_ng",[n],m)[h]();return}i+=g;if(d<e?i>=e:i<e){a[h]();return}}while(j&&new C-f<j);a.cancel=k(q)});return a})}});f.wait=function(a){var b=new f,c=new C;b.cancel=(!a&&f.nextTick||f.delay)(function(){a?b[h](new C-c):b[h]()},a);return b};L(["then","when","each","loop"],function(a){f[a]=function(){return f.prototype[a][v](f.wait(0),arguments)}});typeof module===s&&(module.exports=r);return r}();